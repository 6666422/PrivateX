<html>

    <script src=
    "https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src=
    "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

<button value="pushme" onclick="check()">PUSH ME</button>
<div id="hello">
</div>

<script>
function RequestAuction(div,exchangeid,campaign,url) {
	this.div = div;
    this.exchangeid = exchangeid;
    this.campaignid = campaign;
    this.url = url;
    this.ua = navigator.userAgent;
    this.location = {};
    if (navigator.geolocation) {
        this.location = navigator.geolocation.getCurrentPosition(function(position) {
        	this.location.lat = position.coords.latitude;
        	this.location.lon = position.coords.longitude;
        });
    } 
}

RequestAuction.prototype.getUA = function() {
	return this.ua;
}

RequestAuction.prototype.getPosition = function() {
	return this.location;
}

RequestAuction.prototype.perform = function() {
	var cmd = {};
	cmd.ua = this.ua;
	cmd.location = this.location;
	cmd.accountNumber  = this.exchangeid;
	cmd.campaign = this.campaignid;
	var div = this.div;
	div.innerHTML = "";
    $.ajax({
         type: 'POST',
         url: this.url,
         data: JSON.stringify(cmd),
         success: function(data, textStatus, request){
           if (request.status == 204) {
           	text = "";
           	return;
           } else {
           	text = request.responseText;
           	console.log("TEXT: " + text);
          	div.innerHTML = text;
          }
         },
         error: function (request, textStatus, errorThrown) {
           alert("Error: " + request.responseText);
      }});
}

function check() {
	info = navigator.network;
	alert(info);
	ad.perform();
}

ad = new RequestAuction(document.getElementById("hello"),"pubacct","campname","http://localhost:8080/auction");
	
</script>

<div id="hello"></div>

</html>
